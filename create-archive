#!/bin/bash
set -euo pipefail
tool_name=$1
target_prefix=$2
target_ext=$3
archive_type=$4
build_type=$5
output_dir=$6
archive_file_name=$7

if [ "$archive_type" == '.tar.gz' ]; then
  tar \
    -C $output_dir/$build_type \
    -czf \
    $archive_file_name $target_prefix$tool_name$target_ext
elif [ "$archive_type" == '.zip' ]; then
  (cd $output_dir/$build_type && 7z \
    a \
    -tzip \
    $archive_file_name \
    $target_prefix$tool_name$target_ext)
  mv $output_dir/$build_type/$archive_file_name .
else
  echo "Unsupported archive type $archive_type"
  exit 1
fi
